var editor="";var html="";var config={};var autoSaveId="";var saveInProgress=false;$(document).ready(function(){$(window).on("beforeunload",function(){if(editor!=""){if(postTitleHidden.value.trim()!=postTitleInput.value.trim()||postSummaryHidden.value.trim()!=postSummaryInput.value.trim()||postContentHidden.value.trim()!=editor.getData().trim()){return"There are unsaved changes. Are you sure you want to close?"}}});$("#getMyZonesNext").click(function(){myZonesKeyAlternateRefreshZOHidden.value=myZonesKeyRefreshZOHidden.value;myZonesKeyAlternateRefreshZoneIdHidden.value=myZonesKeyRefreshZoneIdHidden.value;myZonesKeyRefreshZOHidden.value=myZonesKeyNextZOHidden.value;myZonesKeyRefreshZoneIdHidden.value=myZonesKeyNextZoneIdHidden.value;$.ajax({type:"POST",url:"/zone/get-myzones-next",data:{myZonesKeyNextZO:myZonesKeyNextZOHidden.value,myZonesKeyNextZoneId:myZonesKeyNextZoneIdHidden.value},dataType:"json"}).always(function(a){populateMyZones(a)})});$("#getMyZonesPrev").click(function(){$.ajax({type:"POST",url:"/zone/get-myzones-prev",data:{myZonesKeyPrevZO:myZonesKeyPrevZOHidden.value,myZonesKeyPrevZoneId:myZonesKeyPrevZoneIdHidden.value},dataType:"json"}).always(function(a){populateMyZones(a)})});$(".createZone").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}$("body, #createZoneBox, #modal-background").toggleClass("active")});$("#getTopZonesNext").click(function(){topZonesKeyAlternateRefreshZOHidden.value=topZonesKeyRefreshZOHidden.value;topZonesKeyAlternateRefreshZoneIdHidden.value=topZonesKeyRefreshZoneIdHidden.value;topZonesKeyRefreshZOHidden.value=topZonesKeyNextZOHidden.value;topZonesKeyRefreshZoneIdHidden.value=topZonesKeyNextZoneIdHidden.value;$.ajax({type:"POST",url:"/zone/get-topzones-next",data:{topZonesKeyNextZO:topZonesKeyNextZOHidden.value,topZonesKeyNextZoneId:topZonesKeyNextZoneIdHidden.value},dataType:"json"}).always(function(a){populateTopZones(a)})});$("#getTopZonesPrev").click(function(){$.ajax({type:"POST",url:"/zone/get-topzones-prev",data:{topZonesKeyPrevZO:topZonesKeyPrevZOHidden.value,topZonesKeyPrevZoneId:topZonesKeyPrevZoneIdHidden.value},dataType:"json"}).always(function(a){populateTopZones(a)})});$(".favoriteCurrentZone").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}zid=document.getElementById("zoneIdHidden").value;zname=document.getElementById("zoneNameHidden").value;favoriteZoneById(zid,zname)});$(".lastReadPost").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}window.location.href="/zone/"+zoneIdHidden.value});$("#editZoneDesc").on("click","a",(function(){var a=$("#zoneDescDiv").html();$("#zoneDescDiv").html('<textarea cols="52" rows="6" id=zoneDescInput>'+a+"</textarea>");$("#editZoneDesc").html('<input class="activeButton" type=submit value="Save Description">')}));$("#editZoneDesc").on("click","input",(function(){$("#editZoneDesc").html("Please wait...");var a=$("#zoneDescInput").val();$("#zoneDescDiv").html(a);$.post("/zone/update-zone-desc",{zoneId:zoneIdHidden.value,zoneDesc:encodeURIComponent(a)}).always(function(){$("#editZoneDesc").html("<a>Edit Description</a>")})}));$(".becomeAdmin").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}if(confirm('Are you sure you want to become admin of the zone "'+zoneNameHidden.value+'"?')){$.ajax({type:"POST",url:"/zone/become-admin",data:{zoneId:zoneIdHidden.value},dataType:"json"}).always(function(a){$("#adminMessage").html("Congratulations! You are now the admin of this Zone. Please reload the page.")})}});$(".requestAdmin").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}if(confirm('Are you sure you want to request to become one of the admins of the zone "'+zoneNameHidden.value+'"?')){$.ajax({type:"POST",url:"/zone/request-admin",data:{zoneId:zoneIdHidden.value,zoneName:zoneNameHidden.value},dataType:"json"}).always(function(a){$("#adminRequestsMessage").html("Current Admins have been notified of your request.")})}});$("#editZoneWho").on("click","a",(function(){$("#zoneWhoMessage").html("Please wait...");var a=document.getElementById("zoneWhoInput").value.trim();$.post("/zone/update-zone-who",{zoneId:zoneIdHidden.value,zoneWho:encodeURIComponent(a)}).always(function(){$("#zoneWhoMessage").html("Saved.")})}));$(".writePost").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}if(editor!=""){return}var c=document.getElementById("pageTypeHidden").value;if(c=="ZONE"){$("#zoneNameDiv").html("");$("#zoneHeadshotEditControls").html("");$("#zoneAdmins").html("");$("#zoneAdminRequests").html("");$("#zoneDesc").html("");$("#zoneStatsDiv").html("");$("#zoneWhoDiv").html("");$("#zoneTopPostsDiv").html("");document.getElementById("CKEditorFuncNumHidden").value="PostHeadshot"}else{$("#postHIMain").css({display:"none"});$("#postComments").html("");$("#postComment").html("");$("#pageNameDiv").html("");$("#bloggerNameDiv").html("");$("#postTitle").html("")}postIdHidden.value="NEW";publishFlagHidden.value="N";$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish" disabled>&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">');$("#postEditControls").css({"padding-top":"20px"});$("#postSavedTimeStamp").css({display:"block"});var b="&nbsp;";if(primaryPageIdHidden.value==""){b='<div style="margin-top:30px">(2) Business Page: When businesses order blog posts from you, a list of pages appears here.</div><span id="pageIdSelected" style="color:green"> </span>';pageIdSelectedHidden.value=" "}else{b='<div style="margin-top:30px; font-family:Comic Sans MS,Courier; font-size:15px; font-style:italic; color:#939393;">(2) Business Page:</div><div style="font-family:Comic Sans MS,Courier; font-size:15px; font-style:italic; color:#939393;"><input id=pageIdRadio type=radio name=pageIdInput onchange="pageIdSelected.innerHTML=primaryPageIdHidden.value; pageIdSelectedHidden.value=primaryPageIdHidden.value;" checked> <label for="pageIdRadio"> <span id="pageIdSelected" style="color:green; font-weight:bold;"> '+primaryPageIdHidden.value+' </span></label>&nbsp;&nbsp;&nbsp;&nbsp;<input class="activeButton" onclick="showPageBox(\'mrl\');" type="button" value="change page">&nbsp;&nbsp;<span>( You will not be able to publish the blog post if the business page is not active. )</span></div><div style="font-family:Comic Sans MS,Courier; font-size:15px; font-style:italic; color:#939393;"><input id=noPageRadio type=radio name=pageIdInput onchange="pageIdSelected.innerHTML=\'  \'; pageIdSelectedHidden.value=\'  \';"><label for="noPageRadio"> <span style="color:green"> For Pleasure</span></label>&nbsp;&nbsp;<span style="font-size:15px; color:#939393;">( When writing for pleasure, you are not allowed to use backlinks. )</span></div>';pageIdSelectedHidden.value=primaryPageIdHidden.value}$("#postTitleEditControls").html('<div style="margin-top:20px; font-family:Comic Sans MS,Courier; font-size:15px; font-style:italic; color:#939393;">(1) Zone: <span style="color:green; font-weight:bold;">'+zoneNameHidden.value+'</span>&nbsp;&nbsp;<span style="font-size:15px; color:#939393;">( Your blog post will be deleted without notice if the theme of your post does not match with the Zone Name. To change zone, click Close and enter a zone that matches the theme of your blog post. )</span></div>'+b+'<div style="margin-top:30px; font-family:Comic Sans MS,Courier; font-size:15px; font-style:italic; color:#939393">(3) Title:</div><input id="postTitleInput" type=text spellcheck="true" style="width:350px">&nbsp;<input id=similarPosts class="disabledButton" type="button" value="Check if I already published a similar post"><br/>');$("#postTitleEditControls").css({display:"block"});$("#postTitleEditControls").on("change keydown paste input","#postTitleInput",function(){if($("#postTitleInput").val().length>3){$("#similarPosts").css("color","white");$("#similarPosts").css("cursor","pointer");document.getElementById("similarPosts").onclick=function(){checkSimilarPosts()}}else{$("#similarPosts").css("color","#727272");$("#similarPosts").css("cursor","default");document.getElementById("similarPosts").onclick=function(){return false}}});$("#postHeadshotEditControls").css({display:"block"});document.getElementById("headshotImgDiv").style.backgroundImage="url(/resources/images/def-post-image.png)";$("#headshotImgDiv").css({width:"312px"});$("#headshotImgDiv").css({height:"148px"});$("#headshotImgDiv").css({"max-width":""});$("#headshotImgDiv").css({"min-height":""});postHeadshotNewHidden.value="/resources/images/def-post-image.png";$("#postSummaryMain").html('<p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(5) Summary: <br/><input id="postSummaryInput" type=text spellcheck="true" style="width:700px"><br></p>');$("#postContent").html('<p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(6) Content:<ul style="list-style-type:circle"><li>Insert images and slideshows.<li>If you embed an image from external site, make sure the URL starts with https://.<li>Spell Check happens as you type. Use "CTRL+Right Click" to view suggestions.</ul><a style="font-size:13px" target="_blank" href="/do/help/write/posteditor">More help?</a></p>');$("#postContent").css({visibility:"visible"});$("#postContent").css({padding:"0px"});editor=CKEDITOR.appendTo("postContent",config,html);autoSaveId=setInterval("autoSavePost()",120000);postTitleHidden.value=postTitleInput.value;postSummaryHidden.value=postSummaryInput.value;postContentHidden.value=editor.getData()});$("#editPost").click(function(){if(editor!=""){return}var e=publishFlagHidden.value;if(e=="N"||e=="Y"){var d=$("#postTitle").text();if(e=="N"){$("#postEditControls").css({"margin-top":"30px"});$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish">&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">');$("#postTitleEditControls").html('<p style="font-family:Helvetica; font-weight:bold">Let\'s edit your post to perfection!</p><p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(1) Tighten your catchy title.<br><input id="postTitleInput" type=text spellcheck="true" style="width:350px" value=""><br></p>');$("#postTitleEditControls").css({display:"block"})}else{if(e=="Y"){$("#postEditControls").css({"margin-top":"30px"});$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish" disabled>&nbsp;<input id=deletePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete">&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">');$("#postTitleEditControls").html('<p style="font-family:Helvetica; font-weight:bold">Let\'s edit your post to perfection!</p><p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(1) Tighten your catchy title.<br><input id="postTitleInput" type=text spellcheck="true" style="width:350px" value=""><br></p>');$("#postTitleEditControls").css({display:"block"})}}$("#pageNameDiv").html("");$("#bloggerNameDiv").html("");$("#postTitle").html("");$("#postComments").html("");$("#postComment").html("");postTitleInput.value=d;$("#postHeadshotEditControls").css({display:"block"});$("#postHeadshotEditControls").html('<span style="font-family:Comic Sans MS,Courier; font-size:16px; font-style:italic; color:#a0a0a0">(2) Headshot Image: An aspect ratio of 2:1 is recommended for better display. Visit <a target="_blank" href="https://commons.wikimedia.org/wiki/Commons:Free_media_resources/Photography">Commons: Free media resources/Photography</a> to obtain free images. If using a tablet, you may upload images directly from the camera.<br/><input class="activeButton" onclick="showImageBox()" type="button" value="Upload/ Select Post Headshot"></span>');var c=postSummaryHidden.value;$("#postSummaryMain").html('<p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(3) Remove those redundant words from your descriptive summary.<input id="postSummaryInput" type=text spellcheck="true" style="width:550px" value=""><br><br></p>');postSummaryInput.value=c;$("#postHIMain").css({display:"none"});html=document.getElementById("postContent").innerHTML;$("#postContent").html('<p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(4) Make your post content much more impressive!</p>');editor=CKEDITOR.appendTo("postContent",config,html)}else{$("#postEditControls").css({"margin-top":"30px"});$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish">&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">');var d=$("#postTitle").text();$("#postTitleEditControls").html('<p style="font-family:Helvetica; font-weight:bold">Let\'s resurrect your post!</p><p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(1) Tighten your catchy title.<br><input id="postTitleInput" type=text spellcheck="true" style="width:350px" value=""><br></p>');$("#postTitleEditControls").css({display:"block"});postTitleInput.value=d;$("#postHeadshotEditControls").css({display:"block"});$("#postHeadshotEditControls").html('<span style="font-family:Comic Sans MS,Courier; font-size:16px; font-style:italic; color:#a0a0a0">(2) Headshot Image: An aspect ratio of 2:1 is recommended for better display. Visit <a target="_blank" href="https://commons.wikimedia.org/wiki/Commons:Free_media_resources/Photography">Commons: Free media resources/Photography</a> to obtain free images. If using a tablet, you may upload images directly from the camera.<br/><input class="activeButton" onclick="showImageBox()" type="button" value="Upload/ Select Post Headshot"></span>');var c=postSummaryHidden.value;$("#postSummaryMain").html('<p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(3) Remove those redundant words from your descriptive summary.<input id="postSummaryInput" type=text spellcheck="true" style="width:550px" value=""><br><br></p>');postSummaryInput.value=c;$("#postHIMain").css({display:"none"});html=document.getElementById("postContent").innerHTML;$("#postContent").html('<p style="font-family:Comic Sans MS,Courier; font-style:italic; color:#a0a0a0">(4) Make your post content much more impressive before publishing again!</p>');editor=CKEDITOR.appendTo("postContent",config,html)}autoSaveId=setInterval("autoSavePost()",120000);postTitleHidden.value=postTitleInput.value;postSummaryHidden.value=postSummaryInput.value;postContentHidden.value=editor.getData()});$("#getCommentsNext").click(function(){commentsKeyAlternateRefreshHidden.value=commentsKeyRefreshHidden.value;commentsKeyRefreshHidden.value=commentsKeyNextHidden.value;$.ajax({type:"POST",url:"/action/get-comments-next",data:{postId:postIdHidden.value,commentsKeyNext:commentsKeyNextHidden.value},dataType:"json"}).always(function(a){populateComments(a,0)})});$("#getCommentsPrev").click(function(){$.ajax({type:"POST",url:"/action/get-comments-prev",data:{postId:postIdHidden.value,commentsKeyPrev:commentsKeyPrevHidden.value},dataType:"json"}).always(function(a){populateComments(a,0)})});$("#followCommentsA").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}var a=followCommentsA.innerHTML;if(a=="Please wait..."){return false}else{followCommentsA.innerHTML="Please wait..."}var c=0;if(a=="Follow?"){$.ajax({type:"POST",url:"/action/follow-comments",data:{postId:postIdHidden.value},dataType:"json"}).always(function(b){$.each(b,function(d,e){switch(d){case"ERROR":alert(e);break;case"followerId":followerIdHidden.value=e;break;case"cfCount":c=e;break}});followCommentsSpan.innerHTML=c+" blogger(s) are following this post, including yourself. ";followCommentsA.innerHTML="Unfollow?"})}else{$.ajax({type:"POST",url:"/action/unfollow-comments",data:{postId:postIdHidden.value,followerId:followerIdHidden.value},dataType:"json"}).always(function(b){$.each(b,function(d,e){switch(d){case"ERROR":alert(e);break;case"cfCount":c=e;break}});followCommentsSpan.innerHTML=c+" blogger(s) are following this post, but not you. ";followCommentsA.innerHTML="Follow?"})}});$("#requestFB").click(function(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}var a=requestFB.innerHTML;if(a!="Request"){return false}$.ajax({type:"POST",url:"/action/request-fb",data:{postId:postIdHidden.value},dataType:"json"}).always(function(b){$("#requestFBOuter").html("We have received your request to feature this post at www.facebook.com/heatbud.")})});$(".showOnlyAdminsBox").click(function(){$("body, #onlyAdminsBox, #modal-background").toggleClass("active");return false})});function enterMyZone(a){zid=document.getElementById("mzid"+a).value;enterZone(zid,"NO")}function enterTopZone(a){zid=document.getElementById("tzid"+a).value;enterZone(zid,"NO")}function enterZone(d,e){var c=document.createElement("form");c.setAttribute("method","POST");c.setAttribute("action","/do/start");c.setAttribute("target","_self");var a=document.createElement("input");a.setAttribute("name","zoneId");a.setAttribute("value",d);c.appendChild(a);var b=document.createElement("input");b.setAttribute("type","hidden");b.setAttribute("name","myZonesKeyRefreshZO");b.setAttribute("value",myZonesKeyRefreshZOHidden.value);c.appendChild(b);var b=document.createElement("input");b.setAttribute("type","hidden");b.setAttribute("name","myZonesKeyRefreshZoneId");b.setAttribute("value",myZonesKeyRefreshZoneIdHidden.value);c.appendChild(b);var b=document.createElement("input");b.setAttribute("name","myZonesKeyAlternateRefreshZO");b.setAttribute("value",myZonesKeyAlternateRefreshZOHidden.value);c.appendChild(b);var b=document.createElement("input");b.setAttribute("name","myZonesKeyAlternateRefreshZoneId");b.setAttribute("value",myZonesKeyAlternateRefreshZoneIdHidden.value);c.appendChild(b);var g=document.createElement("input");g.setAttribute("name","topZonesKeyRefreshZO");g.setAttribute("value",topZonesKeyRefreshZOHidden.value);c.appendChild(g);var g=document.createElement("input");g.setAttribute("name","topZonesKeyRefreshZoneId");g.setAttribute("value",topZonesKeyRefreshZoneIdHidden.value);c.appendChild(g);var g=document.createElement("input");g.setAttribute("name","topZonesKeyAlternateRefreshZO");g.setAttribute("value",topZonesKeyAlternateRefreshZOHidden.value);c.appendChild(g);var g=document.createElement("input");g.setAttribute("name","topZonesKeyAlternateRefreshZoneId");g.setAttribute("value",topZonesKeyAlternateRefreshZoneIdHidden.value);c.appendChild(g);if(e=="YES"){var g=document.createElement("input");g.setAttribute("name","forceZoneHome");g.setAttribute("value","YES");c.appendChild(g)}document.body.appendChild(c);c.submit()}function createZone(d){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}var b=document.getElementById("createZoneNameInput").value.trim();if(b.length==0){alert("Zone name cannot be empty.");return false}if(b.length>50){alert("Zone name cannot contain more than 50 characters.");return false}var a=document.getElementById("createZoneDescInput").value.trim();if(a.length==0){alert("Zone description cannot be empty.");return false}var c=document.getElementById("createZoneWhoInput").value.trim();$.post("/zone/create",{zoneName:b,zoneDesc:a,zoneWho:c,force:d}).always(function(e){if(e.indexOf("EXISTS:")==0){createZoneMessage.innerHTML=e.substring(8);createZoneButton.onclick=function(){createZone("true")}}else{if(e.indexOf("ERROR:")==0){alert(e.substring(7))}else{window.location.href="/zone/"+e}}})}function deleteMyZone(a){zid=document.getElementById("mzid"+a).value;zname=document.getElementById("mzname"+a).value;if(myZonesCountHidden.value==1){myZonesKeyRefreshZOHidden.value=myZonesKeyAlternateRefreshZOHidden.value;myZonesKeyRefreshZoneIdHidden.value=myZonesKeyAlternateRefreshZoneIdHidden.value;myZonesKeyAlternateRefreshZOHidden.value="NULL";myZonesKeyAlternateRefreshZoneIdHidden.value="NULL"}if(confirm('Are you sure you want to delete the zone "'+zname+'" from My Zones?')){$.ajax({type:"POST",url:"/zone/delete-myzone",data:{zoneId:zid,myZonesKeyRefreshZO:myZonesKeyRefreshZOHidden.value,myZonesKeyRefreshZoneId:myZonesKeyRefreshZoneIdHidden.value},dataType:"json"}).always(function(b){populateMyZones(b)})}}function approveAdmin(b,a){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}if(confirm('Once approved, "'+a+'" will have the same privileges as you in this zone. Proceed?')){$.ajax({type:"POST",url:"/zone/approve-admin",data:{zoneId:zoneIdHidden.value,zoneName:zoneNameHidden.value,adminId:b},dataType:"json"}).always(function(c){$("#adminRequestsMessage").html(a+" has been added as an admin for this zone.")})}}function removeAdmin(b,a){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}if(confirm('Are you sure you want to remove "'+a+'" from being admin of this zone?')){$.ajax({type:"POST",url:"/zone/remove-admin",data:{zoneId:zoneIdHidden.value,zoneName:zoneNameHidden.value,adminId:b},dataType:"json"}).always(function(c){$("#adminMessage").html(a+" has been removed as admin for this zone. Please reload the page.")})}}function favoriteZone(a){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}zid=document.getElementById("tzid"+a).value;zname=document.getElementById("tzname"+a).value;favoriteZoneById(zid,zname)}function favoriteZoneById(a,b){$.ajax({type:"POST",url:"/zone/favorite",data:{zoneId:a,zoneName:b},dataType:"json"}).always(function(c){populateMyZones(c)})}function populateMyZones(a){$.each(a,function(d,f){switch(d){case"ERROR":alert(f);break;case"myZonesList":myZonesCountHidden.value=f.length;var e=new Array(),b=-1;e[++b]='<ul style="list-style-type:none; padding-left:0px">';for(var c=0;c<f.length;c++){myZone=JSON.parse(f[c]);e[++b]='<li class="zoneList myZones" title="';e[++b]=myZone.zoneName.replace(/"/g,"&#034;");e[++b]='"><div class="zoneName" style="width:126px" onclick="enterMyZone(';e[++b]=c;e[++b]=')">';e[++b]=myZone.zoneName;e[++b]='</div><div style="float:left; width:10px; color:#909090; font-size:11px; font-weight:bold" title="Unread Post Count">';if(myZone.unreadCount<100){e[++b]='<span style="background-color:#efefff; padding:0px 4px 0px 4px">'+myZone.unreadCount+"</span>"}else{e[++b]='<span style="background-color:#efefff; padding:0px 4px 0px 4px">99+</span>'}e[++b]='</div><div style="float:left; width:12px" onclick="deleteMyZone(';e[++b]=c;e[++b]=')" title="Remove from favorites">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>';e[++b]='<input type=hidden id="mzid'+c+'" value="'+myZone.zoneId+'">';e[++b]='<input type=hidden id="mzname'+c+'" value="'+myZone.zoneName.replace(/"/g,"&#034;")+'"></li>'}e[++b]='</ul><div style="clear:both"></div>';$("#myZonesList").html(e.join(""));document.getElementById("myZonesDiv").scrollIntoView();window.scrollBy(-10,-10);break;case"myZonesKeyPrevZO":myZonesKeyPrevZOHidden.value=f;if(f=="NULL"){$("#getMyZonesPrevDiv").css("visibility","hidden")}else{$("#getMyZonesPrevDiv").css("visibility","visible")}break;case"myZonesKeyPrevZoneId":myZonesKeyPrevZoneIdHidden.value=f;break;case"myZonesKeyNextZO":myZonesKeyNextZOHidden.value=f;if(f=="NULL"){$("#getMyZonesNextDiv").css("visibility","hidden")}else{$("#getMyZonesNextDiv").css("visibility","visible")}break;case"myZonesKeyNextZoneId":myZonesKeyNextZoneIdHidden.value=f;break;case"myZonesKeyRefreshZO":myZonesKeyRefreshZOHidden.value=f;break;case"myZonesKeyRefreshZoneId":myZonesKeyRefreshZoneIdHidden.value=f;break}})}function populateTopZones(a){$.each(a,function(d,f){switch(d){case"ERROR":alert(f);break;case"topZonesList":topZonesCountHidden.value=f.length;var e=new Array(),b=-1;e[++b]='<ul style="list-style-type:none; padding-left:0px; margin-bottom:0px">';for(var c=0;c<f.length;c++){topZone=JSON.parse(f[c]);e[++b]='<li class="zoneList topZones" title="';e[++b]=topZone.zoneName.replace(/"/g,"&#034;");e[++b]='"><div class="zoneName" onclick="enterTopZone(';e[++b]=c;e[++b]=')">';e[++b]=topZone.zoneName;e[++b]='</div><div id="z'+c+'" class="favorite" style="float:right; width:15px; margin-top:2px;" onclick="favoriteZone(';e[++b]=c;e[++b]="); this.style.backgroundColor='#FF9696'; setTimeout(function() { z"+c+'.style.backgroundColor=\'#ffffff\'; }, 1000);" title="Add this to My Zones">&nbsp;&nbsp;&nbsp;</div>';e[++b]='<input type=hidden id="tzid'+c+'" value="'+topZone.zoneId+'">';e[++b]='<input type=hidden id="tzname'+c+'" value="'+topZone.zoneName.replace(/"/g,"&#034;")+'"></li>'}e[++b]='</ul><div style="clear:both"></div>';$("#topZonesList").html(e.join(""));document.getElementById("myZonesNavigation").scrollIntoView();window.scrollBy(-20,-20);break;case"topZonesKeyPrevZO":topZonesKeyPrevZOHidden.value=f;if(f=="NULL"){$("#getTopZonesPrevDiv").css("visibility","hidden")}else{$("#getTopZonesPrevDiv").css("visibility","visible")}break;case"topZonesKeyPrevZoneId":topZonesKeyPrevZoneIdHidden.value=f;break;case"topZonesKeyNextZO":topZonesKeyNextZOHidden.value=f;if(f=="NULL"){$("#getTopZonesNextDiv").css("visibility","hidden")}else{$("#getTopZonesNextDiv").css("visibility","visible")}break;case"topZonesKeyNextZoneId":topZonesKeyNextZoneIdHidden.value=f;break;case"topZonesKeyRefreshZO":topZonesKeyRefreshZOHidden.value=f;break;case"topZonesKeyRefreshZoneId":topZonesKeyRefreshZoneIdHidden.value=f;break}})}function editZoneName(){var b=document.getElementById("zoneNameHidden").value;zoneNameInput.style.display="block";zoneNameInput.value=b;editZoneNameDiv.innerHTML='<a id="saveZoneName" target="_self" onclick="saveZoneName()" href="javascript:">Save</a>&nbsp;&nbsp;<a id="cancelZoneName" target="_self" onclick="cancelZoneName()" href="javascript:">Cancel</a>';zoneNameRetMessage.innerHTML=""}function cancelZoneName(){zoneNameInput.style.display="none";editZoneNameDiv.innerHTML='<a id="editZoneNameA" style="color:white" target="_self" onclick="editZoneName()" href="javascript:">Edit Zone Name</a>';zoneNameRetMessage.innerHTML=""}function saveZoneName(){var c=zoneNameRetMessage.innerHTML;if(c=="Please wait..."){return false}else{zoneNameRetMessage.innerHTML="Please wait..."}var d=zoneNameInput.value.trim();$.post("/zone/update-zone-name",{zoneId:zoneIdHidden.value,zoneName:encodeURIComponent(d)}).always(function(a){if(a=="SUCCESS"){zoneName.innerHTML=d;document.getElementById("zoneNameHidden").value=d;zoneNameInput.style.display="none";editZoneNameDiv.innerHTML='<a id="editZoneNameA" style="color:white" target="_self" onclick="editZoneName()" href="javascript:">Edit Zone Name</a>';zoneNameRetMessage.innerHTML="Saved."}else{zoneNameRetMessage.innerHTML=a}})}function saveZoneHeadshot(b){$.post("/zone/update-zone-headshot",{zoneId:zoneIdHidden.value,zoneHeadshot:encodeURIComponent(b)}).always(function(a){document.getElementById("headshotImgDiv").style.backgroundImage="url("+b+")"})}function showImageBox(){$("body, #imageBox, #modal-background").toggleClass("active");populateFolders();showContents("common")}function savePost(b){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}if(editor==""){return}if(postTitleInput.value.trim().length==0){alert("Post title cannot be empty.");return false}if(postTitleInput.value.trim().length>100){alert("Post title cannot contain more than 100 characters.");return false}if(postSummaryInput.value.trim().length==0){alert("Post summary cannot be empty.");return false}if(postSummaryInput.value.trim().length>300){alert("Post summary cannot contain more than 300 characters.");return false}if(editor.getData().trim().length==0){alert("Post content cannot be empty.");return false}if(b=="Y"){if(!confirm("Are you ready to publish?")){return false}}if(saveInProgress){if(b=="Y"){alert("Unable to publish. Please try again.")}return false}else{saveInProgress=true}$("#postSavedTimeStamp").css({display:"block"});$("#postSavedTimeStamp").html('<span style="color:#909090">Saving in progress... Please don\'t close the browser.</span>');$("#postEditControls").html('<input id=savePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Saving..." disabled>&nbsp;<input id=publishPost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish" disabled>&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close" disabled>');var c="N";if(postHeadshotOrigHidden.value!=postHeadshotNewHidden.value){c="Y"}var a=new FormData();a.append("postId",postIdHidden.value);a.append("postTitle",postTitleInput.value.trim());a.append("postHeadshot",postHeadshotNewHidden.value);a.append("headshotChanged",c);a.append("postSummary",postSummaryInput.value.trim());a.append("zoneId",zoneIdHidden.value);a.append("pageId",document.getElementById("pageIdSelectedHidden").value);a.append("publishFlag",b);a.append("priorPublishFlag",publishFlagHidden.value);a.append("postContent",editor.getData());$.ajax({type:"POST",async:false,url:"/action/save",data:a,processData:false,contentType:false,dataType:"json"}).always(function(d){$.each(d,function(e,f){switch(e){case"ERROR":$("body, #promptErrorBox, #modal-background").toggleClass("active");$("#errorValue").html(f);$("#postSavedTimeStamp").html('<span style="color:#909090">This post could not be published.</span>');$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish">&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">');return false;break;case"SUCCESS":postTitleHidden.value=postTitleInput.value;postSummaryHidden.value=postSummaryInput.value;postContentHidden.value=editor.getData();postHeadshotOrigHidden.value=postHeadshotNewHidden.value;$("#postSavedTimeStamp").html('<span style="color:#909090">Last saved : '+new Date().toLocaleString()+"</span>");if(b=="Y"){closeEditor()}else{if(publishFlagHidden.value=="Y"){$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish" disabled>&nbsp;<input id=deletePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete">&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">')}else{$("#postEditControls").html('<input id=savePost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save">&nbsp;<input id=publishPost class="activeButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish">&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="activeButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close">')}}break;case"postId":postIdHidden.value=f;break;case"postHeadshot":document.getElementById("headshotImgDiv").style.backgroundImage="url("+f+")";postHeadshotNewHidden.value=f;postHeadshotOrigHidden.value=f;break}})});saveInProgress=false}function autoSavePost(){if(postTitleInput.value.length!=0&&postSummaryInput.value.length!=0&&editor.getData().length!=0){if(postTitleHidden.value.trim()!=postTitleInput.value.trim()||postSummaryHidden.value.trim()!=postSummaryInput.value.trim()||postContentHidden.value.trim()!=editor.getData().trim()){savePost("N")}}}function deletePost(){if(confirm("When you delete a post, Heat Index and Votes will reset to zero. Other users will not see your post content, but it is still available to you for editing and publishing again.\n\nDo you want to proceed?")){$("#postEditControls").html('<input id=savePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'N\')" type="button" value="Save" disabled>&nbsp;<input id=publishPost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="savePost(\'Y\')" type="button" value="Publish" disabled>&nbsp;<input id=deletePost class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="deletePost()" type="button" value="Delete" disabled>&nbsp;<input id=closeEditor class="disabledButton" style="padding-left:20px; padding-right:20px" onclick="closeEditor()" type="button" value="Close" disabled>');$.ajax({type:"POST",url:"/action/delete",data:{postId:postIdHidden.value,zoneId:zoneIdHidden.value,pageId:pageIdHidden.value},dataType:"json"}).always(function(a){$.each(a,function(b,c){switch(b){case"ERROR":alert(c);break}});closeEditor()})}}function purgePost(){$.ajax({type:"POST",url:"/action/purge",data:{postId:postIdHidden.value},dataType:"json"}).always(function(a){$.each(a,function(b,c){switch(b){case"MESSAGE":$("#purgePost").html(c);break}})})}function closeEditor(){clearInterval(autoSaveId);if(postTitleInput.value.length!=0&&postSummaryInput.value.length!=0&&editor.getData().length!=0){if(postTitleHidden.value.trim()!=postTitleInput.value.trim()||postSummaryHidden.value.trim()!=postSummaryInput.value.trim()||postContentHidden.value.trim()!=editor.getData().trim()){$("body, #promptSaveBox, #modal-background").toggleClass("active");return false}}refreshMRL()}function refreshMRL(){if(editor!=""){editor.destroy()}editor="";var a=postIdHidden.value;var c=zoneIdHidden.value;if(a!="PROCESSING"&&a!="NEW"){window.location.href="/post/"+a}else{enterZone(c,"NO")}}function voteDownPost(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}voteDownImg.onclick=function(){return false};voteUpImg.onclick=function(){return false};if(parseInt(currentVoteHidden.value)==-1){alert("You cannot DOWN VOTE this post, because your current vote is already DOWN.")}$.ajax({type:"POST",url:"/action/vote",data:{postId:postIdHidden.value,zoneId:zoneIdHidden.value,zoneName:zoneNameHidden.value,pageId:pageIdHidden.value,newVote:-1},dataType:"json"}).always(function(a){$.each(a,function(b,c){switch(b){case"ERROR":alert(c);break}})});downVotesHidden.value=parseInt(downVotesHidden.value)+1;downVotes.innerHTML=downVotesHidden.value;postHIHidden.value=parseInt(postHIHidden.value)-2;postHI.innerHTML=postHIHidden.value;if(parseInt(currentVoteHidden.value)==1){upVotesHidden.value=parseInt(upVotesHidden.value)-1;upVotes.innerHTML=upVotesHidden.value;postHIHidden.value=parseInt(postHIHidden.value)-2;postHI.innerHTML=postHIHidden.value}currentVoteHidden.value="-1";voteDownImg.style.cursor="default";voteDownImg.title="Your current vote: DOWN";voteUpImg.style.cursor="pointer";voteUpImg.onclick=function(){voteUpPost()};voteUpImg.title="Vote Up"}function voteUpPost(){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}voteUpImg.onclick=function(){return false};voteDownImg.onclick=function(){return false};if(parseInt(currentVoteHidden.value)==1){alert("You cannot UP VOTE this post, because your current vote is already UP.")}$.ajax({type:"POST",url:"/action/vote",data:{postId:postIdHidden.value,zoneId:zoneIdHidden.value,zoneName:zoneNameHidden.value,pageId:pageIdHidden.value,newVote:1},dataType:"json"}).always(function(a){$.each(a,function(b,c){switch(b){case"ERROR":alert(c);break}})});upVotesHidden.value=parseInt(upVotesHidden.value)+1;upVotes.innerHTML=upVotesHidden.value;postHIHidden.value=parseInt(postHIHidden.value)+2;postHI.innerHTML=postHIHidden.value;if(parseInt(currentVoteHidden.value)==-1){downVotesHidden.value=parseInt(downVotesHidden.value)-1;downVotes.innerHTML=downVotesHidden.value;postHIHidden.value=parseInt(postHIHidden.value)+2;postHI.innerHTML=postHIHidden.value}currentVoteHidden.value="1";voteUpImg.style.cursor="default";voteUpImg.title="Your current vote: UP";voteDownImg.style.cursor="pointer";voteDownImg.onclick=function(){voteDownPost()};voteDownImg.title="Vote Down"}function showEmailPostBox(){$("body, #emailPostBox, #modal-background").toggleClass("active");emailPostRetMessage.innerHTML=""}function closeEmailPostBox(){$("body, #emailPostBox, #modal-background").toggleClass("active")}function sendEmailPost(){emailPostButton.onclick=function(){return false};emailPostButton.style.color="rgb(144, 144, 144)";var a=postIdHidden.value;var f=personalMessage.value.trim();var e=recipients.value.trim();if(e.length==0){emailPostRetMessage.innerHTML="Please enter one or more email addresses.";emailPostButton.onclick=function(){sendEmailPost()};emailPostButton.style.color="white";return false}var c=" ",d=" ";if(userIdHidden.value=="NULL"){c=fromEmail.value.trim();d=fromName.value.trim();if(c.length==0){emailPostRetMessage.innerHTML="Please enter your email address.";emailPostButton.onclick=function(){sendEmailPost()};emailPostButton.style.color="white";return false}if(d.length==0){emailPostRetMessage.innerHTML="Please enter your name.";emailPostButton.onclick=function(){sendEmailPost()};emailPostButton.style.color="white";return false}}emailPostRetMessage.innerHTML="Processing...";$.post("/action/email",{postId:a,fromEmail:c,fromName:d,recipients:encodeURIComponent(e),personalMessage:encodeURIComponent(f)}).always(function(b){emailPostRetMessage.innerHTML=b});emailPostButton.onclick=function(){sendEmailPost()};emailPostButton.style.color="white"}function populateComments(b,a){$.each(b,function(e,g){switch(e){case"ERROR":$("#commentsError"+a).text(g);break;case"SUCCESS":$("#commentsError"+a).text(g);break;case"commentsList":commentsCountHidden.value=g.length;var f=new Array(),c=-1;for(var d=0;d<g.length;d++){thanked=parseInt(g[d].commentDate.substring(0,1));a=parseInt(g[d].commentDate.substring(1,14));cd=parseInt(g[d].commentDate.substring(14,27));if(cd==9999999999999){cd=a;commentHeaderCSS="margin-top:16px; background-color:#F5F5F5; border-bottom:1px solid #BBBBBB; padding:4px;";commentIndentCSS=""}else{cd=9999999999999-cd;commentHeaderCSS="";commentIndentCSS="margin-left:15px;"}f[++c]='<div style="font-size:12px; '+commentIndentCSS+commentHeaderCSS+'">';f[++c]='<span id="thankComment'+g[d].commentDate+'Span">';if(thanked=="2"&&cd==a){f[++c]='<img alt="thanked by the blogger" style="max-height:15px; margin-right:10px; border:none" src="/resources/images/thanked.jpg"/>&nbsp;'}f[++c]="</span>";f[++c]='<span style="color:#909090">'+new Date(cd).toLocaleString()+"</span>";f[++c]='<span style="font-weight:bold; color:rgb(144, 144, 144)">&nbsp; . &nbsp;</span>';f[++c]='<a target="_self" href="/'+g[d].commenterId+'">'+g[d].commenterName+"</a>";f[++c]="</div>";f[++c]='<input id="originalComment'+g[d].commentDate+'" type=hidden>';f[++c]='<div id="comment'+g[d].commentDate+'Div" style="'+commentIndentCSS+'margin-top:4px; white-space:pre-line">'+g[d].commentText+"</div>";f[++c]='<textarea id="comment'+g[d].commentDate+'Input" rows="4" cols="95" style="display:none"></textarea>';f[++c]='<div style="'+commentIndentCSS+'font-size:12px; margin-top:8px; margin-bottom:6px">';if(cd==a){f[++c]='<a target="_self" href="javascript:" onclick="showCommentBox(\''+g[d].commentDate+"','"+a+"','"+thanked+'\')" title="Reply to this thread">Reply to this thread</a>';f[++c]='<span style="font-weight:bold; color:rgb(144, 144, 144)">&nbsp; . &nbsp;</span>';if(userIdHidden.value==bloggerIdHidden.value){if(thanked=="1"){f[++c]='<a id="thankComment'+g[d].commentDate+'A" target="_self" href="javascript:" onclick="thankComment(\''+g[d].commentDate+"','2','"+g[d].commenterId+"')\">Thank</a>"}else{f[++c]='<a id="thankComment'+g[d].commentDate+'A" target="_self" href="javascript:" onclick="thankComment(\''+g[d].commentDate+"','1','"+g[d].commenterId+"')\">Unthank</a>"}f[++c]='<span style="font-weight:bold; color:rgb(144, 144, 144)">&nbsp; . &nbsp;</span>'}}if(userIdHidden.value==g[d].commenterId){f[++c]='<span id="editComment'+g[d].commentDate+'Div">';f[++c]='<a id="editComment'+g[d].commentDate+'A" target="_self" href="javascript:" onclick="editComment(\''+g[d].commentDate+'\')" title="Edit this comment">Edit</a></span>';f[++c]='<span style="font-weight:bold; color:rgb(144, 144, 144)">&nbsp; . &nbsp;</span>'}if(userIdHidden.value==g[d].commenterId||userIdHidden.value==bloggerIdHidden.value){f[++c]='<a target="_self" href="javascript:" onclick="deleteComment(\''+g[d].commentDate+'\')" title="Delete this comment">Delete</a>';f[++c]='<span style="font-weight:bold; color:rgb(144, 144, 144)">&nbsp; . &nbsp;</span>'}f[++c]='<a id="reportComment'+g[d].commentDate+'A" target="_self" href="javascript:" onclick="reportComment(\''+g[d].commentDate+'\')" title="Report this comment as spam">Report</a>';if(cd==a){f[++c]='<div id="commentBox'+a+'" style="margin-top:5px">&nbsp;</div>'}f[++c]="</div>"}$("#commentsDiv").html(f.join(""));document.getElementById("postComments").scrollIntoView();break;case"commentsKeyPrev":commentsKeyPrevHidden.value=g;if(g=="NULL"){$("#getCommentsPrevDiv").css("visibility","hidden")}else{$("#getCommentsPrevDiv").css("visibility","visible")}break;case"commentsKeyNext":commentsKeyNextHidden.value=g;if(g=="NULL"){$("#getCommentsNextDiv").css("visibility","hidden")}else{$("#getCommentsNextDiv").css("visibility","visible")}break;case"commentsKeyRefresh":commentsKeyRefreshHidden.value=g;break}})}function editComment(c){var b=document.getElementById("comment"+c+"Div").innerHTML;document.getElementById("originalComment"+c).value=b;document.getElementById("comment"+c+"Div").innerHTML="";document.getElementById("comment"+c+"Input").style.display="block";document.getElementById("comment"+c+"Input").value=b;document.getElementById("editComment"+c+"Div").innerHTML='&nbsp;&nbsp;<a target="_self" id="saveComment'+c+'" onclick="saveComment(\''+c+'\')" href="javascript:">Save</a>&nbsp;&nbsp;.&nbsp;&nbsp;<a target="_self" id="cancelComment'+c+'" onclick="cancelComment(\''+c+'\')" href="javascript:">Cancel</a>'}function cancelComment(a){document.getElementById("comment"+a+"Div").innerHTML=document.getElementById("originalComment"+a).value;document.getElementById("comment"+a+"Input").value="";document.getElementById("comment"+a+"Input").style.display="none";document.getElementById("editComment"+a+"Div").innerHTML='&nbsp;&nbsp;<a target="_self" id="editComment'+a+'A" onclick="editComment(\''+a+'\')" href="javascript:">Edit</a>';commentsRetMessage.innerHTML=""}function saveComment(e){var c=document.getElementById("editComment"+e+"Div").innerHTML;if(c=="Please wait..."){return false}else{document.getElementById("editComment"+e+"Div").innerHTML="Please wait..."}var d=document.getElementById("comment"+e+"Input").value.trim();$.post("/action/update-comment",{postId:postIdHidden.value,commentDate:e,commentText:d}).always(function(a){if(a=="SUCCESS"){document.getElementById("comment"+e+"Div").innerHTML=d;document.getElementById("comment"+e+"Input").value="";document.getElementById("comment"+e+"Input").style.display="none";document.getElementById("editComment"+e+"Div").innerHTML='<a target="_self" id="editComment'+e+'A" onclick="editComment(\''+e+'\')" href="javascript:">Edit</a>';commentsRetMessage.innerHTML=""}else{document.getElementById("editComment"+e+"Div").innerHTML=c;commentsRetMessage.innerHTML=a}})}function reportComment(e){if(userIdHidden.value=="NULL"){$("body, #promptSignupBox, #modal-background").toggleClass("active");return false}var c=document.getElementById("reportComment"+e+"A").innerHTML;if(c=="Please wait..."){return false}else{document.getElementById("reportComment"+e+"A").innerHTML="Please wait..."}var d=document.getElementById("comment"+e+"Div").innerHTML;$.post("/action/report-comment",{postId:postIdHidden.value,commentDate:e,commentText:encodeURIComponent(d)}).always(function(a){document.getElementById("reportComment"+e+"A").innerHTML=c;commentsRetMessage.innerHTML=a})}function thankComment(e,d,c){var a=document.getElementById("thankComment"+e+"A").innerHTML;if(a=="Please wait..."){return false}else{document.getElementById("thankComment"+e+"A").innerHTML="Please wait..."}$.post("/action/thank-comment",{postId:postIdHidden.value,postTitle:postTitle.innerHTML,bloggerId:bloggerIdHidden.value,bloggerName:bloggerName.innerHTML,commentDate:e,thankFlag:d,commenterId:c}).always(function(b){if(a=="Thank"){document.getElementById("thankComment"+e+"A").innerHTML="Unthank";document.getElementById("thankComment"+e+"A").onclick=function(){thankComment(e,"1",c)};document.getElementById("thankComment"+e+"Span").innerHTML='<img alt="thanked by the blogger" style="max-height:12px; margin-right:10px; border:none" src="/resources/images/thanked.jpg"/>&nbsp;'}else{document.getElementById("thankComment"+e+"A").innerHTML="Thank";document.getElementById("thankComment"+e+"A").onclick=function(){thankComment(e,"2",c)};document.getElementById("thankComment"+e+"Span").innerHTML=""}})}function showCommentBox(b,d,e){var c='<div style="float:left"><textarea id=textComment'+d+' rows="4" cols="95" style="width:740px" placeholder="Comments must be relevant to the post content. No Ads or promotions. Heatbud takes spamming seriously."></textarea><br></div><div style="float:right; padding-right:6px; margin-top:3px">';if(userIdHidden.value=="NULL"){c=c+"<input id=email"+d+' name="email" type="text" style="border: 2px solid #BDC7D8; color:rgb(145, 145, 145); letter-spacing:1px; padding:4px; width:310px; border-radius:2px" placeholder="Email (won\'t be published)"><input id=passwd'+d+' type="password" style="border: 2px solid #BDC7D8; color:rgb(145, 145, 145); letter-spacing:1px; padding:4px; width:310px; border-radius:2px" placeholder="Password (if registered user)">'}c=c+"<input id=postComment"+d+' class="activeButton" type="button" onclick="postComment(\''+b+"','"+d+"','"+e+'\')" value="Post Comment"> &nbsp;<input id=hideComment'+d+' class="activeButton" type="button" onclick="hideCommentBox(\''+d+'\')" value="Cancel"></div><div style="clear:both"></div><div id="commentsError'+d+'" class="error">&nbsp;</div>';$("#commentBox"+d).html(c)}function hideCommentBox(a){$("#commentBox"+a).html("&nbsp;")}function postComment(c,d,h){if(document.getElementById("textComment"+d).value.trim().length==0){$("#commentsError"+d).text("Please enter your comment.");return false}var f="NULL";var e="NULL";if(userIdHidden.value=="NULL"){f=document.getElementById("email"+d).value.trim();e=document.getElementById("passwd"+d).value.trim();if(f.length==0){$("#commentsError"+d).text("Please enter your Email Address.");return false}}var a=document.getElementById("postComment"+d).value;if(a=="Please wait..."){return false}else{document.getElementById("postComment"+d).value="Please wait...";document.getElementById("postComment"+d).onclick=function(){return false}}commentsHidden.value=parseInt(commentsHidden.value)+1;comments.innerHTML=commentsHidden.value;var g="";if(d!=0){g=document.getElementById("comment"+c+"Div").innerHTML.trim()}$.ajax({type:"POST",url:"/action/post-comment",data:{postId:postIdHidden.value,postTitle:postTitle.innerHTML,publishFlag:publishFlagHidden.value,zoneId:zoneIdHidden.value,zoneName:zoneNameHidden.value,pageId:pageIdHidden.value,parentCommentDate:d,origCommentText:g,commentText:document.getElementById("textComment"+d).value.trim(),thankedFlag:h,email:f,passwd:e},dataType:"json"}).always(function(b){if(b.hasOwnProperty("SUCCESS")){if(checkCommenterIdExistsHidden.value=="N"){postHIHidden.value=parseInt(postHIHidden.value)+3;postHI.innerHTML=postHIHidden.value;checkCommenterIdExistsHidden.value="Y"}if(d==0||userIdHidden.value=="NULL"){document.getElementById("textComment"+d).value=""}if(userIdHidden.value=="NULL"){$("#commentBox"+d).html('<div id="commentsError'+d+'" class="error">&nbsp;</div>')}}else{document.getElementById("postComment"+d).value=a;document.getElementById("postComment"+d).onclick=function(){postComment(c,d,h)}}populateComments(b,d)})}function deleteComment(c){if(commentsCountHidden.value==1){commentsKeyRefreshHidden.value=commentsKeyAlternateRefreshHidden.value;commentsKeyAlternateRefreshHidden.value="NULL"}if(confirm("Are you sure you want to delete this comment?")){var b=document.getElementById("comment"+c+"Div").innerHTML;$.ajax({type:"POST",url:"/action/delete-comment",data:{zoneId:zoneIdHidden.value,postId:postIdHidden.value,pageId:pageIdHidden.value,commentDate:c,commentText:encodeURIComponent(b),commentsKeyRefresh:commentsKeyRefreshHidden.value},dataType:"json"}).always(function(a){populateComments(a,0)})}}function checkSimilarPosts(){window.open("/search/"+document.getElementById("userIdHidden").value+"/post/"+document.getElementById("postTitleInput").value.trim(),"_blank")}function getRelatedPosts(c){var a=postIdHidden.value;if(a!="PROCESSING"&&a!="NEW"){$.ajax({type:"POST",url:"/action/get-related-posts",data:{postId:a,postTitle:postTitle.innerHTML,rpcPeriod:c},dataType:"json"}).always(function(b){populateRelatedPosts(b)})}}function populateRelatedPosts(a){$.each(a,function(e,h){switch(e){case"ERROR":$("#relatedPostsDiv").text(h);break;case"relatedPostsList":var g=new Array(),b=-1;for(var d=0;d<h.length;d++){g[++b]='<div class="grow" onclick="location.href=\'/post/'+h[d].postId+'\';" style="cursor:pointer; border:1px solid #DDD7D8; padding:4px; margin-right:15px; margin-top:20px; width:244px; height:310px; background-color:white; float:left">';g[++b]='<div style="font-size:16px; font-weight:bold; color:#0074D9; padding:3px 8px">';var c=h[d].postTitle+" ";if(c.length<46){g[++b]=c}else{g[++b]=c.substr(0,45)+"..."}g[++b]="</div>";g[++b]='<div class="topChartsThumb" style="width:232px; height:150px; display:block; margin:0 auto; background-image:url('+h[d].postHeadshot+')"></div>';var f=h[d].postSummary+" ";if(f.length<101){g[++b]='<div style="padding:3px 8px; color:#575757">'+f+"</div>"}else{g[++b]='<div style="padding:3px 8px; color:#575757">'+f.substr(0,100)+"...</div>"}g[++b]="</div>"}g[++b]='<div style="clear:both"></div>';$("#relatedPostsDiv").html(g.join(""));break}})};